name: test
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: docker build
      run: |
        docker build -f Dockerfile . -t gamutrf:latest && \
        docker build -f Dockerfile.graph . -t gamutrf-graph:latest
    - name: static tests
      run: |
        sudo apt-get update && sudo apt-get install -qy python3-dev python3-pip && \
        sudo pip3 install -r requirements.txt -r tests/requirements.txt && \
        pylint --fail-under=5 *py && pytype *py && pytest
